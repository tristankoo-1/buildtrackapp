# Contact Person System - Visual Guide

This document provides visual representations of how the Contact Person system works.

---

## ğŸ“Š System Architecture

### Database Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   companies     â”‚
â”‚  - id           â”‚
â”‚  - name         â”‚
â”‚  - type         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚         â”‚    projects      â”‚
â”‚  - id           â”‚         â”‚  - id            â”‚
â”‚  - name         â”‚         â”‚  - name          â”‚
â”‚  - company_id   â”‚         â”‚  - company_id â—„â”€â”€â”¼â”€â”€â”€ Owner Company
â”‚  - email        â”‚         â”‚  - created_by â—„â”€â”€â”¼â”€â”€â”€ Initial Contact Person
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â”‚                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚  â”‚
         â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â””â”€â”€â”¼â”€â”€â”€â”€â”¤ company_project_relationships        â”‚
            â”‚    â”‚  - id                                â”‚
            â”‚    â”‚  - project_id                        â”‚
            â””â”€â”€â”€â”€â”¤  - company_id                        â”‚
                 â”‚  - parent_company_id (hierarchy)     â”‚
            â”Œâ”€â”€â”€â”€â”¤  - contact_person_user_id â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ WHO is contact
            â”‚    â”‚  - relationship_type                 â”‚
            â”‚    â”‚  - invited_by_user_id                â”‚
            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚
       â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ user_project_roles â”‚
       â”‚  - user_id         â”‚
       â”‚  - project_id      â”‚
       â”‚  - role_id         â”‚
       â”‚  - is_contact_person (flag)
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Company Hierarchy Examples

### Example 1: Simple Two-Level Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PROJECT: Office Building                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                       â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   BuildTrack Inc.  â”‚  â”‚   Task Flow        â”‚
      â”‚      (Owner)       â”‚  â”‚                    â”‚
      â”‚  Level: 0          â”‚  â”‚                    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ John Doe    â”‚  â”‚ Sarah Worker  â”‚
â”‚ Contact Person â”‚  â”‚ Team Member   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Can invite subcontractors
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        â”‚            â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”
â”‚Electricâ”‚ â”‚Plumbingâ”‚ â”‚ HVAC    â”‚ â”‚Paintingâ”‚
â”‚Co.     â”‚ â”‚Pro     â”‚ â”‚Systems  â”‚ â”‚Plus    â”‚
â”‚        â”‚ â”‚        â”‚ â”‚         â”‚ â”‚        â”‚
â”‚â­Mike  â”‚ â”‚â­Susan â”‚ â”‚â­Carlos â”‚ â”‚â­David â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Level 1    Level 1    Level 1     Level 1
```

### Example 2: Three-Level Hierarchy (Sub-subcontractors)

```
                    ğŸ¢ BuildTrack Inc. (Owner)
                         â­ John (Contact)
                         ğŸ‘¤ Sarah
                         ğŸ‘¤ Alex
                              â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚            â”‚            â”‚
         ğŸ¢ Electric Co.  ğŸ¢ Plumbing  ğŸ¢ HVAC
         â­ Mike (Contact)  â­ Susan    â­ Carlos
         ğŸ‘¤ Lisa                          â”‚
              â”‚                           â”‚
              â”‚                      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚                      â”‚         â”‚
     ğŸ¢ Wire Specialists      ğŸ¢ Duct Co.  ğŸ¢ Controls
     â­ Bob (Contact)         â­ Frank     â­ Grace
     ğŸ‘¤ Tom
     ğŸ‘¤ Jerry
```

**Visibility in Example 2:**

| User | Can See Users |
|------|---------------|
| **John (Owner)** | John, Sarah, Alex, Mike, Susan, Carlos |
| **Sarah (Owner Team)** | John, Sarah, Alex |
| **Mike (Level 1)** | John, Sarah, Alex, Mike, Lisa |
| **Lisa (Level 1 Team)** | John, Sarah, Alex, Mike, Lisa |
| **Bob (Level 2)** | John, Sarah, Alex, Mike, Lisa, Bob, Tom, Jerry |
| **Tom (Level 2 Team)** | John, Sarah, Alex, Mike, Lisa, Bob, Tom, Jerry |
| **Carlos (Level 1)** | John, Sarah, Alex, Carlos, Frank, Grace |

**Key Point:** John CANNOT see Bob, Tom, or Jerry (they're downstream of Mike)

---

## ğŸ”„ Task Assignment Flow

### Scenario: Owner Assigns Task to Subcontractor

```
STEP 1: Task Creation
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  John (BuildTrack)  â”‚
â”‚  "Paint the lobby"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ assigns to
           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Task #123   â”‚
     â”‚ Status: New â”‚
     â”‚ Owner: John â”‚
     â”‚ Assigned:   â”‚
     â”‚  - David    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 2: David Accepts
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ David (Painting Plus)â”‚
â”‚ Accepts task         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Task #123   â”‚
     â”‚ Status:     â”‚
     â”‚  Accepted   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 3: David Delegates to Team
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ David                â”‚
â”‚ "I'll assign this to"â”‚
â”‚ "my team members"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ can assign to:
           â”‚  âœ… His team members
           â”‚  âœ… His subcontractors
           â”‚  âœ… Upstream (John, Sarah, Alex)
           â”‚
           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Sub-Task A  â”‚
     â”‚ Assigned:   â”‚
     â”‚  - Emma     â”‚ â—„â”€â”€â”€ David's team member
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Sub-Task B  â”‚
     â”‚ Assigned:   â”‚
     â”‚  - Frank    â”‚ â—„â”€â”€â”€ David's subcontractor
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 4: John's View
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ John sees:           â”‚
â”‚                      â”‚
â”‚ Task #123            â”‚
â”‚  Assigned to: David  â”‚
â”‚  Status: In Progress â”‚
â”‚                      â”‚
â”‚  âŒ Cannot see       â”‚
â”‚     Sub-Task A (Emma)â”‚
â”‚  âŒ Cannot see       â”‚
â”‚     Sub-Task B (Frankâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¥ User Selection UI Mockups

### When Creating a Task (Contact Person View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Task                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Title: Install electrical panels          â”‚
â”‚  Description: ________________________     â”‚
â”‚              ________________________     â”‚
â”‚                                            â”‚
â”‚  ğŸ“ Assign To:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ” Search users...                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  â–¼ My Team (BuildTrack Inc.)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â˜ ğŸ‘¤ Sarah Worker                    â”‚ â”‚
â”‚  â”‚ â˜ ğŸ‘¤ Alex Admin                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  â–¼ Subcontractors                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â˜‘ â­ Mike Johnson                    â”‚ â”‚
â”‚  â”‚    Elite Electric Co.                â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ â˜ â­ Susan Smith                     â”‚ â”‚
â”‚  â”‚    Plumbing Pro                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  âš ï¸ Note: Only contact persons of         â”‚
â”‚     subcontractors are shown              â”‚
â”‚                                            â”‚
â”‚  [Cancel]                   [Create Task] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### When Creating a Task (Regular Team Member View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Task                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Title: Review blueprints                  â”‚
â”‚  Description: ________________________     â”‚
â”‚              ________________________     â”‚
â”‚                                            â”‚
â”‚  ğŸ“ Assign To:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ” Search users...                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  â–¼ My Team (BuildTrack Inc.)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â˜ â­ John Doe (Contact Person)       â”‚ â”‚
â”‚  â”‚ â˜ ğŸ‘¤ Sarah Worker                    â”‚ â”‚
â”‚  â”‚ â˜ ğŸ‘¤ Alex Admin                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  â„¹ï¸ You can only assign to your team      â”‚
â”‚                                            â”‚
â”‚  [Cancel]                   [Create Task] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¨ Invitation Flow

### Flow 1: Invite Team Member (Same Company)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  John (Contact)      â”‚
â”‚  BuildTrack Inc.     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ clicks "Add Team Member"
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Add Team Member                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Select from company:               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â˜ Emma Johnson                â”‚ â”‚
â”‚  â”‚   Not on this project         â”‚ â”‚
â”‚  â”‚                               â”‚ â”‚
â”‚  â”‚ â˜ Robert Lee                  â”‚ â”‚
â”‚  â”‚   Not on this project         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  [Cancel]              [Add (2)]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ adds
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Emma & Robert       â”‚
â”‚  Added to project    â”‚
â”‚  Role: Worker        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flow 2: Invite Subcontractor (External Company)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  John (Contact)      â”‚
â”‚  BuildTrack Inc.     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ clicks "Invite Subcontractor"
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Invite Subcontractor               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Contact Information:               â”‚
â”‚  Email: mike@electric.com           â”‚
â”‚  Phone: (555) 123-4567              â”‚
â”‚                                     â”‚
â”‚  â˜‘ Designate as Contact Person     â”‚
â”‚     for their company               â”‚
â”‚                                     â”‚
â”‚  Proposed Role:                     â”‚
â”‚  âšª Contractor                      â”‚
â”‚  â¦¿ Subcontractor                   â”‚
â”‚  âšª Inspector                       â”‚
â”‚                                     â”‚
â”‚  Message (optional):                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ We need electrical work for   â”‚ â”‚
â”‚  â”‚ the office building project.  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  [Cancel]           [Send Invite]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ sends
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“§ Email/SMS to Mike                â”‚
â”‚  "John invited you to join           â”‚
â”‚   Office Building project as         â”‚
â”‚   Contact Person for Elite Electric" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Mike clicks link
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Accept Invitation                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Project: Office Building           â”‚
â”‚  Invited by: John (BuildTrack Inc.) â”‚
â”‚                                     â”‚
â”‚  You will be the Contact Person     â”‚
â”‚  for Elite Electric Co. on this     â”‚
â”‚  project.                           â”‚
â”‚                                     â”‚
â”‚  As Contact Person you can:         â”‚
â”‚  âœ“ Add your team members            â”‚
â”‚  âœ“ Invite your subcontractors       â”‚
â”‚  âœ“ Assign tasks to your team        â”‚
â”‚                                     â”‚
â”‚  [Decline]              [Accept]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ accepts
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Success!                         â”‚
â”‚  You are now part of the project    â”‚
â”‚  as Contact Person.                 â”‚
â”‚                                      â”‚
â”‚  Next steps:                         â”‚
â”‚  â€¢ Add your team members             â”‚
â”‚  â€¢ Review assigned tasks             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ Visibility States

### Example: Multi-Company Project View

#### John's View (Owner Company Contact Person)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Project Members (8)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¢ BuildTrack Inc. (My Company)   â”‚
â”‚    â­ John Doe (You)               â”‚
â”‚    ğŸ‘¤ Sarah Worker                 â”‚
â”‚    ğŸ‘¤ Alex Admin                   â”‚
â”‚                                    â”‚
â”‚  ğŸ¢ Elite Electric Co.             â”‚
â”‚    â­ Mike Johnson (Contact)       â”‚
â”‚    â„¹ï¸ 2 team members               â”‚ â—„â”€ Can't see details
â”‚                                    â”‚
â”‚  ğŸ¢ Plumbing Pro                   â”‚
â”‚    â­ Susan Smith (Contact)        â”‚
â”‚    â„¹ï¸ 1 team member                â”‚ â—„â”€ Can't see details
â”‚                                    â”‚
â”‚  ğŸ¢ HVAC Systems                   â”‚
â”‚    â­ Carlos Rodriguez (Contact)   â”‚
â”‚    â„¹ï¸ 3 team members               â”‚ â—„â”€ Can't see details
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Mike's View (Subcontractor Contact Person)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Project Members (6)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¢ BuildTrack Inc. (Owner)        â”‚
â”‚    â­ John Doe (Contact)           â”‚
â”‚    ğŸ‘¤ Sarah Worker                 â”‚
â”‚    ğŸ‘¤ Alex Admin                   â”‚
â”‚                                    â”‚
â”‚  ğŸ¢ Elite Electric Co. (My Company)â”‚
â”‚    â­ Mike Johnson (You)           â”‚
â”‚    ğŸ‘¤ Lisa Martinez                â”‚
â”‚                                    â”‚
â”‚  ğŸ¢ Wire Specialists               â”‚  â—„â”€ Mike's subcontractor
â”‚    â­ Bob Smith (Contact)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ Cannot see: Plumbing Pro, HVAC Systems (sibling subcontractors)
```

#### Sarah's View (Owner Company Team Member)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Project Members (3)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¢ BuildTrack Inc. (My Company)   â”‚
â”‚    â­ John Doe (Contact)           â”‚
â”‚    ğŸ‘¤ Sarah Worker (You)           â”‚
â”‚    ğŸ‘¤ Alex Admin                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ Cannot see: Any subcontractors (not contact person)
âœ… Can see them if assigned task by/to them
```

---

## ğŸ”€ Contact Person Transfer Flow

```
BEFORE TRANSFER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BuildTrack Inc.         â”‚
â”‚ â­ John (Contact)       â”‚ â—„â”€â”€â”€ Has all permissions
â”‚ ğŸ‘¤ Sarah                â”‚
â”‚ ğŸ‘¤ Alex                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: John initiates transfer
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Transfer Contact Person Role       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Current: John Doe (You)            â”‚
â”‚                                     â”‚
â”‚  Transfer to:                       â”‚
â”‚  â¦¿ Sarah Worker                     â”‚
â”‚  âšª Alex Admin                      â”‚
â”‚                                     â”‚
â”‚  âš ï¸ Warning:                        â”‚
â”‚  You will lose the ability to:     â”‚
â”‚  â€¢ Invite subcontractors            â”‚
â”‚  â€¢ Add team members                 â”‚
â”‚  â€¢ Manage project access            â”‚
â”‚                                     â”‚
â”‚  This action cannot be undone.      â”‚
â”‚                                     â”‚
â”‚  [Cancel]              [Transfer]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 2: Confirm
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Confirm Transfer                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Are you sure you want to transfer  â”‚
â”‚  Contact Person role to Sarah?      â”‚
â”‚                                     â”‚
â”‚  Type "TRANSFER" to confirm:        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ TRANSFER                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  [Cancel]              [Confirm]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER TRANSFER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BuildTrack Inc.         â”‚
â”‚ ğŸ‘¤ John                 â”‚
â”‚ â­ Sarah (Contact)      â”‚ â—„â”€â”€â”€ Now has all permissions
â”‚ ğŸ‘¤ Alex                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Permission Matrix

### Actions by User Type

| Action | Owner Contact | Subcontractor Contact | Team Member | Admin |
|--------|---------------|----------------------|-------------|-------|
| **Add team members from own company** | âœ… | âœ… | âŒ | âœ… |
| **Remove team members from own company** | âœ… | âœ… | âŒ | âœ… |
| **Invite subcontractor company** | âœ… | âœ… | âŒ | âœ… |
| **See all subcontractor team members** | âŒ | âŒ | âŒ | âœ… |
| **See upstream company members** | N/A | âœ… | âœ… | âœ… |
| **Assign task to subcontractor contact** | âœ… | âœ… | âŒ | âœ… |
| **Assign task to own team** | âœ… | âœ… | âœ… | âœ… |
| **Transfer contact person role** | âœ… | âœ… | âŒ | âœ… |
| **Leave project** | âŒ* | âŒ* | âœ… | âœ… |

*Must transfer contact person role first

---

## ğŸ” Search & Filter UI

### User Search with Visibility
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Select User                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” Search: "john"                         â”‚
â”‚                                            â”‚
â”‚  Results (showing only visible users):     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â­ John Doe                          â”‚ â”‚
â”‚  â”‚    BuildTrack Inc. (Contact Person)  â”‚ â”‚
â”‚  â”‚    âœ“ Can assign tasks                â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ John Smith                        â”‚ â”‚
â”‚  â”‚    BuildTrack Inc.                   â”‚ â”‚
â”‚  â”‚    âœ“ Same company                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                            â”‚
â”‚  Filters:                                  â”‚
â”‚  â˜‘ My Company                              â”‚
â”‚  â˜‘ Contact Persons                         â”‚
â”‚  â˜ Subcontractors                          â”‚
â”‚  â˜ Task-related only                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scalability Visualization

### Large Project with Many Subcontractors
```
                        ğŸ¢ Owner (Level 0)
                        â­ 1 Contact + 10 team
                                â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                     â”‚                     â”‚
    ğŸ¢ Sub 1 (L1)         ğŸ¢ Sub 2 (L1)        ğŸ¢ Sub 3 (L1)
    â­ 1 + 5 team         â­ 1 + 8 team        â­ 1 + 3 team
          â”‚                     â”‚                     â”‚
     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
     â”‚         â”‚           â”‚         â”‚          â”‚         â”‚
  Sub 1.1   Sub 1.2     Sub 2.1   Sub 2.2    Sub 3.1   Sub 3.2
  â­1+2     â­1+4       â­1+6     â­1+3      â­1+5     â­1+7
     â”‚
  Sub 1.1.1
  â­1+3

Total: 15 companies, ~70 users
Owner sees: 1 + 10 + 3 = 14 users (own team + 3 L1 contacts)
Sub 1 sees: 1 + 5 + 11 + 2 = 19 users (own, owner, 2 L2 contacts)
```

**Visibility Scales:**
- User only sees relevant people
- Database queries use indexes
- RLS ensures security
- O(1) lookup for contact person
- O(log n) for hierarchy traversal

---

*For complete technical implementation details, see `CONTACT_PERSON_IMPLEMENTATION_PLAN.md`*

