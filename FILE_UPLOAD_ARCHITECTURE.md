# ğŸ—ï¸ BuildTrack File Upload Architecture

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          BUILDTRACK MOBILE APP                          â”‚
â”‚                      (React Native + Expo SDK 54)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                               â”‚                               â”‚
    â–¼                               â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Camera  â”‚                  â”‚ Gallery  â”‚                   â”‚ Document â”‚
â”‚ Picker  â”‚                  â”‚ Picker   â”‚                   â”‚  Picker  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                               â”‚                               â”‚
    â”‚          expo-image-picker    â”‚      expo-document-picker    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  expo-file-system     â”‚
                        â”‚  (Read file as base64)â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ useFileUpload Hook    â”‚
                        â”‚ (Business Logic)      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ fileUploadService.ts  â”‚
                        â”‚ (API Layer)           â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                   â”‚                   â”‚
                â–¼                   â–¼                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Validate   â”‚   â”‚   Upload to  â”‚   â”‚   Save to    â”‚
        â”‚  File Type   â”‚   â”‚   Storage    â”‚   â”‚   Database   â”‚
        â”‚  & Size      â”‚   â”‚              â”‚   â”‚              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                   â”‚                   â”‚
                â”‚                   â”‚                   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SUPABASE BACKEND                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
                â”‚                               â”‚
                â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SUPABASE STORAGE        â”‚       â”‚   POSTGRESQL DATABASE     â”‚
â”‚   (Object Storage)        â”‚       â”‚   (Metadata Storage)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           â”‚       â”‚                           â”‚
â”‚ ğŸ“¦ buildtrack-files       â”‚       â”‚ ğŸ“Š file_attachments       â”‚
â”‚    (Private Bucket)       â”‚       â”‚    (Table)                â”‚
â”‚    - Max 50MB             â”‚       â”‚    - id                   â”‚
â”‚    - Company isolated     â”‚       â”‚    - file_name            â”‚
â”‚    - Authenticated only   â”‚       â”‚    - file_type            â”‚
â”‚                           â”‚       â”‚    - storage_path         â”‚
â”‚ Structure:                â”‚       â”‚    - public_url           â”‚
â”‚  {company_id}/            â”‚       â”‚    - entity_type          â”‚
â”‚    tasks/                 â”‚       â”‚    - entity_id            â”‚
â”‚      {task_id}/           â”‚       â”‚    - uploaded_by          â”‚
â”‚        file-123.jpg       â”‚       â”‚    - company_id           â”‚
â”‚        doc-456.pdf        â”‚       â”‚    - timestamps           â”‚
â”‚    projects/              â”‚       â”‚    - soft delete          â”‚
â”‚      {project_id}/        â”‚       â”‚                           â”‚
â”‚        ...                â”‚       â”‚ ğŸ”’ RLS Policies:          â”‚
â”‚                           â”‚       â”‚    - Company isolation    â”‚
â”‚ ğŸ“¦ buildtrack-public      â”‚       â”‚    - Role-based access    â”‚
â”‚    (Public Bucket)        â”‚       â”‚    - Owner verification   â”‚
â”‚    - Max 10MB             â”‚       â”‚                           â”‚
â”‚    - Public readable      â”‚       â”‚ ğŸ“ˆ Indexes:               â”‚
â”‚    - Logos & banners      â”‚       â”‚    - entity lookup        â”‚
â”‚                           â”‚       â”‚    - company lookup       â”‚
â”‚ Structure:                â”‚       â”‚    - date range           â”‚
â”‚  companies/               â”‚       â”‚                           â”‚
â”‚    {company_id}/          â”‚       â”‚                           â”‚
â”‚      logo.png             â”‚       â”‚                           â”‚
â”‚      banner.jpg           â”‚       â”‚                           â”‚
â”‚                           â”‚       â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
                â”‚    ğŸ”’ Storage Policies        â”‚    ğŸ”’ RLS Policies
                â”‚    - Company folders          â”‚    - SELECT: Own company
                â”‚    - Auth required            â”‚    - INSERT: Authenticated
                â”‚    - Owner for delete         â”‚    - UPDATE: Owner/Admin
                â”‚                               â”‚    - DELETE: Soft only
                â”‚                               â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Returns Public URL  â”‚
                    â”‚   + File Metadata     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MOBILE APP UI                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CreateTaskScreen â”‚ â”‚TaskDetailScr.â”‚ â”‚AdminDashboardâ”‚
    â”‚                  â”‚ â”‚              â”‚ â”‚              â”‚
    â”‚ - Attach files   â”‚ â”‚ - View files â”‚ â”‚ - Logo/bannerâ”‚
    â”‚ - Show preview   â”‚ â”‚ - Add photos â”‚ â”‚ - Upload     â”‚
    â”‚ - Upload progressâ”‚ â”‚ - Delete     â”‚ â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚               â”‚               â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚FileAttachmentPreview  â”‚
                    â”‚     Component         â”‚
                    â”‚                       â”‚
                    â”‚ - Image preview       â”‚
                    â”‚ - Document icon       â”‚
                    â”‚ - File size           â”‚
                    â”‚ - Delete button       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagrams

### Upload Flow

```
1. User Action
   â”‚
   â–¼
   User taps "Upload Photo" button
   â”‚
   â–¼
2. Permission Check
   â”‚
   â”œâ”€â†’ Camera: Request camera permission
   â””â”€â†’ Gallery: Request media library permission
   â”‚
   â–¼
3. File Selection
   â”‚
   â”œâ”€â†’ Camera: Take photo (expo-image-picker)
   â”œâ”€â†’ Gallery: Select images (expo-image-picker, multiple)
   â””â”€â†’ Documents: Select files (expo-document-picker)
   â”‚
   â–¼
4. File Processing
   â”‚
   â”œâ”€â†’ Read file as base64 (expo-file-system)
   â”œâ”€â†’ Get file info (size, name, type)
   â””â”€â†’ Validate file (size < 50MB, allowed MIME type)
   â”‚
   â–¼
5. Upload to Storage
   â”‚
   â”œâ”€â†’ Generate unique filename (timestamp-originalname)
   â”œâ”€â†’ Determine storage path ({company_id}/{entity_type}/{entity_id}/file)
   â”œâ”€â†’ Upload to Supabase Storage (supabase.storage.upload)
   â””â”€â†’ Get public URL
   â”‚
   â–¼
6. Save Metadata
   â”‚
   â”œâ”€â†’ Determine file type (image/document/video/other)
   â”œâ”€â†’ Insert to file_attachments table
   â”‚   - file_name, file_type, file_size
   â”‚   - storage_path, public_url
   â”‚   - entity_type, entity_id
   â”‚   - uploaded_by, company_id
   â””â”€â†’ Get record ID
   â”‚
   â–¼
7. Update UI
   â”‚
   â”œâ”€â†’ Add to local state
   â”œâ”€â†’ Show preview
   â””â”€â†’ Display success message
   â”‚
   â–¼
8. Complete âœ…
```

### Retrieval Flow

```
1. Component Mount
   â”‚
   â–¼
   Screen loads (e.g., TaskDetailScreen)
   â”‚
   â–¼
2. Fetch Files
   â”‚
   â”œâ”€â†’ Call getFilesForEntity(entity_type, entity_id)
   â””â”€â†’ Query file_attachments table
       WHERE entity_type = 'task'
       AND entity_id = '{task_id}'
       AND deleted_at IS NULL
   â”‚
   â–¼
3. RLS Check (Automatic)
   â”‚
   â”œâ”€â†’ Verify user's company_id matches file's company_id
   â””â”€â†’ Return only authorized files
   â”‚
   â–¼
4. Render Files
   â”‚
   â”œâ”€â†’ Map through file list
   â”œâ”€â†’ Render FileAttachmentPreview for each
   â”‚   - If image: Show thumbnail
   â”‚   - If document: Show icon
   â”‚   - Show file name and size
   â””â”€â†’ Add delete button (if authorized)
   â”‚
   â–¼
5. Display âœ…
```

### Delete Flow

```
1. User Action
   â”‚
   â–¼
   User taps delete button on file preview
   â”‚
   â–¼
2. Confirm Delete
   â”‚
   â””â”€â†’ Show confirmation alert (optional)
   â”‚
   â–¼
3. Soft Delete
   â”‚
   â”œâ”€â†’ Call deleteFile(file_id, user_id)
   â”œâ”€â†’ Update file_attachments
   â”‚   SET deleted_at = NOW()
   â”‚   SET deleted_by = user_id
   â”‚   WHERE id = file_id
   â””â”€â†’ RLS verifies user permission
   â”‚
   â–¼
4. Update UI
   â”‚
   â”œâ”€â†’ Remove from local state
   â””â”€â†’ Hide from display
   â”‚
   â–¼
5. Complete âœ…

Note: File remains in storage for potential recovery
Hard delete can be done by admin via cleanup function
```

---

## Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY LAYERS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Authentication
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase Auth (JWT Tokens)                     â”‚
â”‚  - Email/password authentication                 â”‚
â”‚  - Session management                            â”‚
â”‚  - Auto token refresh                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
Layer 2: User Identity
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Users Table                                     â”‚
â”‚  - id (UUID) â†’ auth.uid()                       â”‚
â”‚  - company_id â†’ Company isolation               â”‚
â”‚  - role â†’ Permission level                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
Layer 3: Row Level Security (RLS)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database Policies                               â”‚
â”‚  âœ“ SELECT: Own company only                     â”‚
â”‚  âœ“ INSERT: Authenticated + company match        â”‚
â”‚  âœ“ UPDATE: Owner or admin only                  â”‚
â”‚  âœ“ DELETE: Soft delete only                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
Layer 4: Storage Policies
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bucket Access Control                           â”‚
â”‚  âœ“ Upload: Own company folder only              â”‚
â”‚  âœ“ Read: Own company files only                 â”‚
â”‚  âœ“ Delete: Owner or admin only                  â”‚
â”‚  âœ“ Path validation: {company_id} must match     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
Layer 5: File Validation
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Trigger Validation                              â”‚
â”‚  âœ“ File size: <= 50MB                           â”‚
â”‚  âœ“ MIME type: Whitelist only                    â”‚
â”‚  âœ“ Extension check                               â”‚
â”‚  âœ“ Company isolation                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
Layer 6: Application Logic
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client-side Validation                          â”‚
â”‚  âœ“ File type check before upload                â”‚
â”‚  âœ“ Size check before upload                     â”‚
â”‚  âœ“ Permission check before action               â”‚
â”‚  âœ“ Error handling                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”’ Result: Multi-layer security with defense in depth
```

---

## Component Hierarchy

```
App
â”‚
â”œâ”€â”€ AppNavigator
â”‚   â”‚
â”‚   â”œâ”€â”€ LoginScreen
â”‚   â”‚
â”‚   â””â”€â”€ MainStack
â”‚       â”‚
â”‚       â”œâ”€â”€ DashboardScreen
â”‚       â”‚
â”‚       â”œâ”€â”€ ProjectsScreen
â”‚       â”‚   â””â”€â”€ ProjectDetailScreen
â”‚       â”‚
â”‚       â”œâ”€â”€ TasksScreen
â”‚       â”‚   â”œâ”€â”€ TaskDetailScreen
â”‚       â”‚   â”‚   â”œâ”€â”€ FileAttachmentPreview (multiple) ğŸ†•
â”‚       â”‚   â”‚   â””â”€â”€ [Add Photos Button â†’ useFileUpload hook] ğŸ†•
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ CreateTaskScreen
â”‚       â”‚       â”œâ”€â”€ FileAttachmentPreview (multiple) ğŸ†•
â”‚       â”‚       â””â”€â”€ [Upload Button â†’ useFileUpload hook] ğŸ†•
â”‚       â”‚
â”‚       â””â”€â”€ AdminDashboardScreen
â”‚           â””â”€â”€ [Banner/Logo Upload â†’ useFileUpload hook] ğŸ†•
â”‚
â”œâ”€â”€ State Management (Zustand)
â”‚   â”œâ”€â”€ authStore (existing)
â”‚   â”œâ”€â”€ taskStore (update with file methods) ğŸ”„
â”‚   â””â”€â”€ [Could add: fileStore for centralized file management] ğŸ†•
â”‚
â””â”€â”€ Services/Utils
    â”œâ”€â”€ api/
    â”‚   â”œâ”€â”€ supabase.ts (existing)
    â”‚   â””â”€â”€ fileUploadService.ts ğŸ†•
    â”‚       â”œâ”€â”€ uploadFile()
    â”‚       â”œâ”€â”€ getFilesForEntity()
    â”‚       â”œâ”€â”€ deleteFile()
    â”‚       â””â”€â”€ permanentlyDeleteFile()
    â”‚
    â”œâ”€â”€ utils/
    â”‚   â””â”€â”€ useFileUpload.ts ğŸ†•
    â”‚       â”œâ”€â”€ pickAndUploadImages()
    â”‚       â””â”€â”€ pickAndUploadDocuments()
    â”‚
    â””â”€â”€ components/
        â””â”€â”€ FileAttachmentPreview.tsx ğŸ†•

Legend:
ğŸ†• New files/components to create
ğŸ”„ Existing files to update
```

---

## Database Schema Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    file_attachments                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Column           â”‚ Type / Constraints                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               â”‚ UUID PRIMARY KEY (auto-generated)        â”‚
â”‚ file_name        â”‚ TEXT NOT NULL                            â”‚
â”‚ file_type        â”‚ TEXT NOT NULL (image/document/video)     â”‚
â”‚ file_size        â”‚ INTEGER NOT NULL (max 50MB)              â”‚
â”‚ mime_type        â”‚ TEXT NOT NULL (validated)                â”‚
â”‚ storage_path     â”‚ TEXT NOT NULL UNIQUE                     â”‚
â”‚ public_url       â”‚ TEXT NOT NULL                            â”‚
â”‚ entity_type      â”‚ TEXT NOT NULL (task/project/etc.)        â”‚
â”‚ entity_id        â”‚ UUID NOT NULL                            â”‚
â”‚ uploaded_by      â”‚ UUID FK â†’ users(id)                      â”‚
â”‚ company_id       â”‚ UUID FK â†’ companies(id) CASCADE          â”‚
â”‚ description      â”‚ TEXT (optional)                           â”‚
â”‚ tags             â”‚ TEXT[] DEFAULT '{}'                       â”‚
â”‚ created_at       â”‚ TIMESTAMPTZ DEFAULT NOW()                â”‚
â”‚ updated_at       â”‚ TIMESTAMPTZ DEFAULT NOW()                â”‚
â”‚ deleted_at       â”‚ TIMESTAMPTZ (soft delete)                â”‚
â”‚ deleted_by       â”‚ UUID FK â†’ users(id)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Relationships
                    â”œâ”€â†’ users (uploaded_by)
                    â”œâ”€â†’ users (deleted_by)
                    â”œâ”€â†’ companies (company_id)
                    â””â”€â†’ Can link to: tasks, projects, etc. (via entity_id)
```

---

## File Upload State Machine

```
[IDLE]
  â”‚
  â”‚ User taps upload
  â”‚
  â–¼
[SELECTING FILE]
  â”‚
  â”œâ”€â†’ User cancels â”€â”€â†’ [IDLE]
  â”‚
  â”‚ User selects file
  â”‚
  â–¼
[VALIDATING]
  â”‚
  â”œâ”€â†’ Invalid file â”€â”€â†’ [ERROR] â”€â”€â†’ Show error â”€â”€â†’ [IDLE]
  â”‚
  â”‚ File valid
  â”‚
  â–¼
[UPLOADING]
  â”‚ (Show progress: 0-100%)
  â”‚
  â”œâ”€â†’ Network error â”€â”€â†’ [RETRY] â”€â”€â”
  â”‚                                â”‚
  â”‚                           Retry or Cancel
  â”‚                                â”‚
  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”‚ Upload successful
  â”‚
  â–¼
[SAVING METADATA]
  â”‚
  â”œâ”€â†’ Database error â”€â”€â†’ [ERROR] â”€â”€â†’ Cleanup + Show error â”€â”€â†’ [IDLE]
  â”‚
  â”‚ Metadata saved
  â”‚
  â–¼
[SUCCESS]
  â”‚
  â”‚ Show preview
  â”‚ Update UI
  â”‚
  â–¼
[IDLE]
```

---

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRONTEND                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React Native             â”‚ v0.81.4                         â”‚
â”‚  Expo SDK                 â”‚ v54.0                           â”‚
â”‚  TypeScript               â”‚ v5.8.3                          â”‚
â”‚  Zustand                  â”‚ v5.0.4 (State management)       â”‚
â”‚  NativeWind               â”‚ v4.1.23 (Styling)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  expo-image-picker        â”‚ v16.1.4 (Camera/gallery)        â”‚
â”‚  expo-document-picker     â”‚ v13.1.5 (Documents)             â”‚
â”‚  expo-file-system         â”‚ v18.1.8 (File operations)       â”‚
â”‚  expo-image-manipulator   â”‚ v13.1.5 (Compression)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BACKEND                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Supabase                 â”‚ Cloud backend platform          â”‚
â”‚  PostgreSQL               â”‚ v15 (Database)                  â”‚
â”‚  Supabase Storage         â”‚ Object storage (S3-compatible)  â”‚
â”‚  Supabase Auth            â”‚ JWT authentication              â”‚
â”‚  Row Level Security       â”‚ Database-level security         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INTEGRATIONS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @supabase/supabase-js    â”‚ v2.75.0 (Client library)        â”‚
â”‚  base64-arraybuffer       â”‚ For file encoding               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Size Limits & Recommendations

```
File Type          | Max Size | Recommended | Format
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Photos (Camera)    | 50 MB    | 2-5 MB      | JPEG (compressed)
Photos (Gallery)   | 50 MB    | 2-5 MB      | JPEG/PNG
Documents (PDF)    | 50 MB    | 1-10 MB     | PDF
Office Docs        | 50 MB    | 1-5 MB      | DOCX/XLSX
Videos             | 50 MB    | N/A         | Not recommended
                                               (size limit)

Compression Strategy:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Images             | Use expo-image-manipulator
                  | Quality: 0.7 (70%)
                  | Max width: 1920px
                  | Expected reduction: 50-70%

Documents         | No compression (preserve quality)

Videos            | Not recommended due to size
                  | Consider alternative (external links)
```

---

## Performance Considerations

```
Optimization                | Impact          | Priority
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Image compression           | High (70% size) | âš¡ HIGH
Thumbnail generation        | Medium          | ğŸ”¶ MEDIUM
Lazy loading file lists     | Medium          | ğŸ”¶ MEDIUM
Caching public URLs         | Low             | ğŸŸ¡ LOW
Parallel uploads            | Medium          | ğŸ”¶ MEDIUM
Progress indicators         | High (UX)       | âš¡ HIGH
Retry mechanism             | High (UX)       | âš¡ HIGH
Offline queue               | Medium          | ğŸŸ¡ LOW

Expected Performance:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Upload Time (5MB image)     | ~5-10 seconds
Upload Time (1MB document)  | ~2-5 seconds
Fetch file list (10 files)  | ~1-2 seconds
Delete file                 | ~1 second
Large file (45MB)           | ~30-60 seconds

Network Conditions:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Fast WiFi (50+ Mbps)        | Excellent
4G LTE (10-20 Mbps)         | Good
3G (1-5 Mbps)               | Acceptable (with compression)
Slow 3G (<1 Mbps)           | Poor (show warning)
```

---

## Error Handling Flow

```
Error Type                  | Handler                | User Action
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
No Internet Connection     | Detect + Queue         | Show offline banner
                                                     | Retry when online

Permission Denied          | Alert user             | Show settings link
(Camera/Gallery)                                    | Explain why needed

File Too Large            | Validate before upload  | Show size limit
                                                     | Suggest compression

Invalid File Type         | Validate before upload  | Show allowed types
                                                     | Explain restriction

Storage Quota Exceeded    | Catch from Supabase    | Contact admin
                                                     | Show usage stats

Network Timeout           | Retry mechanism         | Auto-retry (3x)
                                                     | Then show error

Database Error            | Log + rollback          | Generic error msg
                                                     | Support contact

Upload Failed             | Cleanup + error msg     | Retry button
(Generic)                                           | Cancel option

RLS Policy Blocked        | Detect + explain        | Contact admin
                                                     | Explain permissions
```

---

## Cost Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COST BREAKDOWN                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Supabase Free Tier:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Resource           â”‚ Limit       â”‚ Usage Strategy           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Storage            â”‚ 1 GB        â”‚ â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡ ~30% (300MB)  â”‚
â”‚                    â”‚             â”‚ â€¢ Compress images        â”‚
â”‚                    â”‚             â”‚ â€¢ Delete old files       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bandwidth          â”‚ 2 GB/month  â”‚ â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡ ~30% (600MB)  â”‚
â”‚                    â”‚             â”‚ â€¢ Use thumbnails         â”‚
â”‚                    â”‚             â”‚ â€¢ Cache URLs             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Database           â”‚ 500 MB      â”‚ â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡ ~20% (100MB)  â”‚
â”‚                    â”‚             â”‚ â€¢ Metadata only          â”‚
â”‚                    â”‚             â”‚ â€¢ Regular cleanup        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cost Projections:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usage Tier         â”‚ Monthly Costâ”‚ Capacity                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Free               â”‚ $0          â”‚ ~100 images + 50 docs    â”‚
â”‚                    â”‚             â”‚ Good for: 5-10 users     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pro                â”‚ $25         â”‚ ~10,000 images + 5k docs â”‚
â”‚                    â”‚             â”‚ Good for: 50+ users      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Team               â”‚ $599        â”‚ Unlimited                â”‚
â”‚                    â”‚             â”‚ Enterprise scale         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Upgrade Triggers:
â€¢ Storage > 800 MB (80% of free tier)
â€¢ Bandwidth > 1.6 GB/month (80% of free tier)
â€¢ User count > 20
â€¢ Support needs increase
```

---

## Monitoring Dashboard (Conceptual)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FILE UPLOAD METRICS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Real-time Stats:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Total Files        â”‚ 1,234 â¬† +12 today                       â”‚
â”‚ Total Size         â”‚ 456 MB / 1 GB (46%) âš                    â”‚
â”‚ Bandwidth (30d)    â”‚ 1.2 GB / 2 GB (60%) âœ“                   â”‚
â”‚ Upload Success     â”‚ 98.5% âœ“                                 â”‚
â”‚ Avg Upload Time    â”‚ 8.2 seconds âœ“                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

File Distribution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Images             â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 834 (67%)       â”‚
â”‚ Documents          â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 312 (25%)       â”‚
â”‚ Other              â”‚ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  88 (8%)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Recent Activity:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Time               â”‚ User         â”‚ Action               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2 min ago          â”‚ John Doe     â”‚ Uploaded photo.jpg   â”‚
â”‚ 5 min ago          â”‚ Jane Smith   â”‚ Uploaded doc.pdf     â”‚
â”‚ 8 min ago          â”‚ Bob Wilson   â”‚ Deleted old-file.jpg â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Alerts:
âš  Storage at 46% - Consider cleanup or upgrade
âœ“ All systems operational
```

---

**Architecture planning complete!** ğŸ‰

This architecture supports:
âœ… Scalable file storage
âœ… Secure access control
âœ… Multi-layer security
âœ… Cost-effective operations
âœ… Great user experience
âœ… Easy monitoring

Ready for implementation!

